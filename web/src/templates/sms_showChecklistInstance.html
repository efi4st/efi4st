{% extends "layout.html" %}

{% block content %}
<!-- Main jumbotron for a primary marketing message or call to action -->
<div class="jumbotron banner">
  <div class="container">
    <div class="row">
      <div class="col-md-3"></div>
      <div class="col-md-8">
        <h1 class="display-3" ></h1>
      </div>
      <div class="col-md-1"></div>
    </div>
  </div>
</div>

      <div class="container">
        {% if error|length > 1 %}
        <div class="alert alert-warning" role="alert">
          {{error}}
        </div>
        {% endif %}
      </div>

<!-- sms_showChecklistInstance.html -->
<div class="container mt-4">
  <h2>Checkliste Instanz</h2>
  <p>Status: <strong>{{ instance.Status }}</strong></p>

  <table class="table table-bordered table-sm">
    <thead class="thead-light">
    <tr>
      <th>Scope</th>
      <th>Test & Expected Result</th>
      <th>Actual-Value</th>
      <th>OK?</th>
      <th>Comment</th>
      <th>Save</th>
    </tr>
    </thead>
    <tbody>
    {% for item in items %}
    <tr>
      <form action="/sms_checklistItemInstance/update" method="POST">
        <input type="hidden" name="ChecklistItemInstanceID" value="{{ item.ChecklistItemInstanceID }}">
        <input type="hidden" name="ChecklistInstanceID" value="{{ instance.ChecklistInstanceID }}">
        <td>
          {% if item.TargetObjectType == "device" %}
          <a href="/sms_devices/show/{{ item.TargetObjectID }}">
            Device #{{ item.TargetObjectID }}
          </a>
          {% elif item.TargetObjectType == "system" %}
          <a href="/sms_projects/show/{{ item.TargetObjectID }}">
            System (Project #{{ item.TargetObjectID }})
          </a>
          {% elif item.TargetObjectType == "deviceInstance" %}
          <a href="/sms_projects/show/{{ item.TargetObjectID }}">
            Device Instance (Project #{{ item.TargetObjectID }})
          </a>
          {% else %}
          Unknown Type #{{ item.TargetObjectID }}
          {% endif %}
        </td>
        <td>{{ item.ExpectedValue }}</td>
        <td>
          <input class="form-control form-control-sm" type="text" name="ActualValue" value="{{ item.ActualValue }}">
        </td>
        <td>
          <select class="form-control form-control-sm" name="IsOK">
            <option value="" {% if item.IsOKStr == "none" %}selected{% endif %}>–</option>
            <option value="true" {% if item.IsOKStr == "true" %}selected{% endif %}>✅</option>
            <option value="false" {% if item.IsOKStr == "false" %}selected{% endif %}>❌</option>
          </select>
        </td>
        <td>
          <input class="form-control form-control-sm" type="text" name="Comment" value="{{ item.Comment }}">
        </td>
        <td>
          <button class="btn btn-sm btn-success" type="submit"><i class="fa fa-save"></i></button>
        </td>
      </form>
    </tr>
    {% endfor %}
    </tbody>
  </table>

  <a class="btn btn-secondary" href="/sms_checklistInstance/markStatus/{{ instance.ChecklistInstanceID }}?status=done">
    Mark as done
  </a>
</div>
{% endblock %}



